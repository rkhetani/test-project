



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content=""">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.2">
    
    
      
        <title>"DGE visualization of results"</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.ba0fd1a6.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="light-green">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#learning-objectives" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="RSK's test doc" class="md-header-nav__button md-logo">
          
            <img src="../images/dna-sequence-1600x800.jpg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                RSK's test doc
              </span>
              <span class="md-header-nav__topic">
                Data Visualization
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../images/dna-sequence-1600x800.jpg" width="48" height="48">
      
    </span>
    RSK's test doc
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../README/" title="Training materials" class="md-nav__link">
      Training materials
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Data Visualization
      </label>
    
    <a href="./" title="Data Visualization" class="md-nav__link md-nav__link--active">
      Data Visualization
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" title="Learning Objectives" class="md-nav__link">
    Learning Objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracting-significant-differentially-expressed-genes" title="Extracting significant differentially expressed genes" class="md-nav__link">
    Extracting significant differentially expressed genes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizing-the-results" title="Visualizing the results" class="md-nav__link">
    Visualizing the results
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-signicant-de-genes" title="Plotting signicant DE genes" class="md-nav__link">
    Plotting signicant DE genes
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-deseq2-plotcounts-to-plot-expression-of-a-single-gene" title="Using DESeq2 plotCounts() to plot expression of a single gene" class="md-nav__link">
    Using DESeq2 plotCounts() to plot expression of a single gene
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ggplot2-to-plot-expression-of-a-single-gene" title="Using ggplot2 to plot expression of a single gene" class="md-nav__link">
    Using ggplot2 to plot expression of a single gene
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ggplot2-to-plot-multiple-genes-eg-top-20" title="Using ggplot2 to plot multiple genes (e.g. top 20)" class="md-nav__link">
    Using ggplot2 to plot multiple genes (e.g. top 20)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heatmap" title="Heatmap" class="md-nav__link">
    Heatmap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volcano-plot" title="Volcano plot" class="md-nav__link">
    Volcano plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" title="Learning Objectives" class="md-nav__link">
    Learning Objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extracting-significant-differentially-expressed-genes" title="Extracting significant differentially expressed genes" class="md-nav__link">
    Extracting significant differentially expressed genes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizing-the-results" title="Visualizing the results" class="md-nav__link">
    Visualizing the results
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-signicant-de-genes" title="Plotting signicant DE genes" class="md-nav__link">
    Plotting signicant DE genes
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-deseq2-plotcounts-to-plot-expression-of-a-single-gene" title="Using DESeq2 plotCounts() to plot expression of a single gene" class="md-nav__link">
    Using DESeq2 plotCounts() to plot expression of a single gene
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ggplot2-to-plot-expression-of-a-single-gene" title="Using ggplot2 to plot expression of a single gene" class="md-nav__link">
    Using ggplot2 to plot expression of a single gene
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ggplot2-to-plot-multiple-genes-eg-top-20" title="Using ggplot2 to plot multiple genes (e.g. top 20)" class="md-nav__link">
    Using ggplot2 to plot multiple genes (e.g. top 20)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heatmap" title="Heatmap" class="md-nav__link">
    Heatmap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volcano-plot" title="Volcano plot" class="md-nav__link">
    Volcano plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Data Visualization</h1>
                
                <p>Approximate time: 75 minutes</p>
<h2 id="learning-objectives">Learning Objectives</h2>
<ul>
<li>Exploring our significant genes using data visualization</li>
<li>Using volcano plots to evaluate relationships between DEG statistics</li>
<li>Plotting expression of significant genes using heatmaps</li>
</ul>
<h2 id="extracting-significant-differentially-expressed-genes">Extracting significant differentially expressed genes</h2>
<p>What we noticed is that the FDR threshold on it's own doesn't appear to be reducing the number of significant genes. With large significant gene lists it can be hard to extract meaningful biological relevance. To help increase stringency, one can also <strong>add a fold change threshold</strong>. <em>The <code>summary()</code> function doesn't have an argument for fold change threshold</em></p>
<blockquote>
<p><em>NOTE:</em> the <code>results()</code> function does have an option to add a fold change threshold and subset the data this way. Take a look at the help manual using <code>?results</code> and see what argument would be required. However, rather than subsetting the results, we want to return the whole dataset and simply identify which genes meet our criteria. </p>
</blockquote>
<p>Let's first create variables that contain our threshold criteria:</p>
<pre><code class="r">### Set thresholds
padj.cutoff &lt;- 0.05
lfc.cutoff &lt;- 0.58
</code></pre>

<p>The <code>lfc.cutoff</code> is set to 0.58; remember that we are working with log2 fold changes so this translates to an actual fold change of 1.5 which is pretty reasonable. Let's create vector that helps us identify the genes that meet our criteria:</p>
<pre><code class="r">threshold &lt;- res_tableOE$padj &lt; padj.cutoff &amp; abs(res_tableOE$log2FoldChange) &gt; lfc.cutoff
</code></pre>

<p>We now have a logical vector of values that has a length which is equal to the total number of genes in the dataset. The elements that have a <code>TRUE</code> value correspond to genes that meet the criteria (and <code>FALSE</code> means it fails). <strong>How many genes are differentially expressed in the Overexpression compared to Control, given our criteria specified above?</strong> Does this reduce our results? </p>
<pre><code class="r">length(which(threshold))
</code></pre>

<p>To add this vector to our results table we can use the <code>$</code> notation to create the column on the left hand side of the assignment operator, and the assign the vector to it instead of using <code>cbind()</code>:</p>
<pre><code class="r">res_tableOE$threshold &lt;- threshold                
</code></pre>

<p>Now we can easily subset the results table to only include those that are significant using the <code>subset()</code> function:</p>
<pre><code class="r">sigOE &lt;- data.frame(subset(res_tableOE, threshold==TRUE))
</code></pre>

<p>Using the same thresholds as above (<code>padj.cutoff &lt; 0.05</code> and <code>lfc.cutoff = 0.58</code>), create a threshold vector to report the number of genes that are up- and down-regulated in Mov10_knockdown compared to control.</p>
<pre><code class="r">threshold_KD &lt;- res_tableKD$padj &lt; padj.cutoff &amp; abs(res_tableKD$log2FoldChange) &gt; lfc.cutoff
</code></pre>

<p>Take this new threshold vector and add it as a new column called <code>threshold</code> to the <code>res_tableKD</code> which contains a logical vector denoting genes as being differentially expressed or not. <strong>How many genes are differentially expressed in the Knockdown compared to Control?</strong> Subset the data to keep only the significant genes.</p>
<pre><code class="r">res_tableKD$threshold &lt;- threshold_KD

sigKD &lt;- data.frame(subset(res_tableKD, threshold==TRUE))
</code></pre>

<h2 id="visualizing-the-results">Visualizing the results</h2>
<p>When we are working with large amounts of data it can be useful to display that information graphically to gain more insight. Visualization deserves an entire course of its own, but during this lesson we will get you started with some basic and more advanced plots commonly used when exploring differential gene expression data.</p>
<p>Let's start by loading a few libraries:</p>
<pre><code class="r"># Load libraries
library(DESeq2)
library(reshape)
library(ggplot2)
library(ggrepel)
library(DEGreport)
library(RColorBrewer)
library(pheatmap)
</code></pre>

<h3 id="plotting-signicant-de-genes">Plotting signicant DE genes</h3>
<p>One way to visualize results would be to simply plot the expression data for a handful of genes. We could do that by picking out specific genes of interest or selecting a range of genes:</p>
<h4 id="using-deseq2-plotcounts-to-plot-expression-of-a-single-gene"><strong>Using DESeq2 <code>plotCounts()</code> to plot expression of a single gene</strong></h4>
<p>To pick out a specific gene of interest to plot, for example Mov10, we can use the <code>plotCounts()</code> from DESeq2:</p>
<pre><code class="r"># Plot expression for single gene
plotCounts(dds, gene=&quot;MOV10&quot;, intgroup=&quot;sampletype&quot;) 
</code></pre>

<p><img src="../img/topgen_plot.png" width="500"></p>
<p><strong>This function only allows for plotting the counts of a single gene at a time.</strong> </p>
<h4 id="using-ggplot2-to-plot-expression-of-a-single-gene"><strong>Using ggplot2 to plot expression of a single gene</strong></h4>
<p>If you wish to change the appearance of this plot, we can save the output of <code>plotCounts()</code> to a variable specifying the <code>returnData=TRUE</code> argument, then use <code>ggplot()</code>:</p>
<pre><code class="r"># Save plotcounts to variable
d &lt;- plotCounts(dds, gene=&quot;MOV10&quot;, intgroup=&quot;sampletype&quot;, returnData=TRUE)

# Adding samplenames to data frame
d$name &lt;- rownames(d)

# Plotting the MOV10 normalized counts
ggplot(d, aes(x=sampletype, y=count, color=sampletype)) + 
  geom_point(position=position_jitter(w=0.1,h=0)) +
  geom_text_repel(aes(label = name)) + 
  theme_bw() +
  ggtitle(&quot;MOV10&quot;) +
  theme(plot.title=element_text(hjust=0.5))
</code></pre>

<blockquote>
<p>Note that in the plot below (code above), we are using <code>geom_text_repel()</code> from the 'ggrepel' R package to label our individual points on the plot.</p>
</blockquote>
<p><img src="../img/plotCounts_ggrepel.png" width="600"></p>
<h4 id="using-ggplot2-to-plot-multiple-genes-eg-top-20"><strong>Using <code>ggplot2</code> to plot multiple genes (e.g. top 20)</strong></h4>
<p>Often it is helpful to check the expression of multiple genes of interest at the same time. While this isn't easily done using the <code>plotCounts()</code> function, we can use <code>ggplot()</code> to do this after performing some data wrangling.</p>
<p>We are going to plot the normalized count values for the <strong>top 20 differentially expressed genes (by padj values)</strong>. </p>
<p>To do this, we first need to determine the gene names of our top 20 genes by ordering our significant results and extracting the top 20 genes:</p>
<pre><code class="r">## Order significant results by padj values
sigOE_ordered &lt;- sigOE[order(sigOE$padj), ]
top20_sigOE_genes &lt;- rownames(sigOE_ordered[1:20, ])
</code></pre>

<p>Then, we can extract the normalized count values for these top 20 genes:</p>
<pre><code class="r">## normalized counts for top 20 significant genes
normalized_counts &lt;- counts(dds, normalized=T)
top20_sigOE_norm &lt;- normalized_counts[top20_sigOE_genes, ]
</code></pre>

<p>Now that we have the normalized counts for each of the top 20 genes for all 8 samples, to plot using <code>ggplot()</code>, we need to gather the counts for all samples into a single column to allow us to give ggplot the one column with the values we want it to plot.</p>
<p>The <code>melt()</code> function in the <strong>reshape</strong> R package will perform this operation and will output the normalized counts for all genes for <em>Mov10_oe_1</em> listed in the first 20 rows, followed by the normalized counts for <em>Mov10_oe_2</em> in the next 20 rows, so on and so forth.</p>
<p><img src="../img/melt_wide_to_long_format.png" width="800"></p>
<pre><code class="r">## use melt to modify the format of the data frame
melted_top20_sigOE &lt;- data.frame(melt(top20_sigOE_norm))

## check the column header in the &quot;melted&quot; data frame
View(melted_top20_sigOE)

## add column names that make sense
colnames(melted_top20_sigOE) &lt;- c(&quot;gene&quot;, &quot;samplename&quot;, &quot;normalized_counts&quot;)
</code></pre>

<p>Now, if we want our counts colored by sample group, then we need to combine the metadata information with the melted normalized counts data into the same data frame for input to <code>ggplot()</code>:</p>
<pre><code class="r">## add metadata to &quot;melted&quot; dataframe
meta$samplename &lt;- rownames(meta)

melted_top20_sigOE &lt;- merge(melted_top20_sigOE, meta)
</code></pre>

<p>The <code>merge()</code> will merge 2 data frames with respect to the "samplename" column, i.e. a column with the same colname in both data frames.</p>
<p>Now that we have a data frame in a format that can be utilised by ggplot easily, let's plot! </p>
<pre><code class="r">## plot using ggplot2
ggplot(melted_top20_sigOE) +
        geom_point(aes(x = gene, y = normalized_counts, color = sampletype)) +
        scale_y_log10() +
        xlab(&quot;Genes&quot;) +
        ylab(&quot;Normalized Counts&quot;) +
        ggtitle(&quot;Top 20 Significant DE Genes&quot;) +
        theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    theme(plot.title=element_text(hjust=0.5))
</code></pre>

<p><img src="../img/sig_genes_melt.png" width="600"></p>
<h3 id="heatmap">Heatmap</h3>
<p>In addition to plotting subsets, we could also extract the normalized values of <em>all</em> the significant genes and plot a heatmap of their expression using <code>pheatmap()</code>.</p>
<pre><code class="r">### Extract normalized expression for significant genes
norm_OEsig &lt;- normalized_counts[rownames(sigOE),]
</code></pre>

<p>Now let's draw the heatmap using <code>pheatmap</code>:</p>
<pre><code class="r">### Annotate our heatmap (optional)
annotation &lt;- data.frame(sampletype=meta[,'sampletype'], 
                     row.names=rownames(meta))

### Set a color palette
heat.colors &lt;- brewer.pal(6, &quot;YlOrRd&quot;)

### Run pheatmap
pheatmap(norm_OEsig, color = heat.colors, cluster_rows = T, show_rownames=F,
annotation= annotation, border_color=NA, fontsize = 10, scale=&quot;row&quot;,
     fontsize_row = 10, height=20)
</code></pre>

<p><img src="../img/sigOE_heatmap.png" width="500"></p>
<blockquote>
<p><em>NOTE:</em> There are several additional arguments we have included in the function for aesthetics. One important one is <code>scale="row"</code>, in which Z-scores are plotted, rather than the actual normalized count value. Z-scores are computed on a gene-by-gene basis by subtracting the mean and then dividing by the standard deviation. The Z-scores are computed <strong>after the clustering</strong>, so that it only affects the graphical aesthetics and the color visualization is improved.</p>
</blockquote>
<h3 id="volcano-plot">Volcano plot</h3>
<p>Heatmaps are great to look at the expression levels of a fairly large number of genes, but for more of a global view we can use the volcano plot. Here, the log transformed adjusted p-values are plotted on the y-axis and log2 fold change values on the x-axis. There is no built-in function for the drawing volcano plots in DESeq2, just as there is none for heatmaps, but we can easily draw it using <code>ggplot2</code>. </p>
<p>To generate a volcano plot, we have a column in our results data indicating whether or not the gene is considered differentially expressed based on p-adjusted and log2 foldchange values. First, we need to convert our results object into a data frame.</p>
<pre><code class="r">resOE_df &lt;- data.frame(res_tableOE)

View(resOE_df)
</code></pre>

<p>Since we have the <code>threshold</code> column,  we can start plotting. The <code>geom_point</code> object is most applicable, as this is essentially a scatter plot:</p>
<pre><code class="r"># Volcano plot
ggplot(resOE_df) +
  geom_point(aes(x=log2FoldChange, y=-log10(padj), colour=threshold)) +
  ggtitle(&quot;Mov10 overexpression&quot;) +
  xlab(&quot;log2 fold change&quot;) + 
  ylab(&quot;-log10 adjusted p-value&quot;) +
  theme(legend.position = &quot;none&quot;,
        plot.title = element_text(size = rel(1.5), hjust = 0.5),
        axis.title = element_text(size = rel(1.25)))  
</code></pre>

<p><img src="../img/volcanoplot-1.png" width="500"> </p>
<p>This is a great way to get an overall picture of what is going on, but what if we also wanted to know where the top 10 genes (lowest padj) in our DE list are located on this plot? We could label those dots with the gene name on the Volcano plot using <code>geom_text_repel()</code>.</p>
<p>To make this work we have to take the following 3 steps:
(Step 1) Create a new data frame sorted or ordered by padj
(Step 2) Indicate in the data frame which genes we want to label by adding a logical vector to it, wherein "TRUE" = genes we want to label.</p>
<pre><code class="r">resOE_df_ordered &lt;- resOE_df[order(resOE_df$padj), ] 

resOE_df_ordered$genelabels &lt;- rownames(resOE_df_ordered) %in% rownames(resOE_df_ordered[1:10,])

View(resOE_df_ordered)
</code></pre>

<p>(Step 3) Finally, we need to add the <code>geom_text_repel()</code> layer to the ggplot code we used before, and let it know which genes we want labelled. </p>
<pre><code class="r">ggplot(resOE_df_ordered) +
  geom_point(aes(x = log2FoldChange, y = -log10(padj), colour = threshold)) +
  geom_text_repel(aes(x = log2FoldChange, y = -log10(padj), label = ifelse(genelabels == T, rownames(resOE_df_ordered),&quot;&quot;))) +
  ggtitle(&quot;Mov10 overexpression&quot;) +
  xlab(&quot;log2 fold change&quot;) + 
  ylab(&quot;-log10 adjusted p-value&quot;) +
  theme(legend.position = &quot;none&quot;,
        plot.title = element_text(size = rel(1.5), hjust = 0.5),
        axis.title = element_text(size = rel(1.25))) 
</code></pre>

<p><img src="../img/volcanoplot-2.png" width="500"> </p>
<p>The <code>ifelse()</code> function is a simple function that outputs a vector if a certain condition is T. In the above example, it checks if the value in the <code>resOE_df_ordered$genelevel</code> column is TRUE, in which case it will output the row name for that row (<code>rownames(resOE_df_ordered)</code>). If the value in the genelevel column is FALSE it will output nothing (<code>""</code>). This is good way to inform <code>geom_point()</code> about genes we want labeled.</p>
<hr />
<p><em><strong>NOTE:</strong> The package 'DEGreport' can make the top20 genes and the volcano plots generated above by writing a few lines of simple code. While you can customize the plots above, you may be interested in using the easier code. Below are examples for code to create these plots:</em></p>
<pre><code class="r">DEGreport::degPlot(dds = dds, res = res, n=20, xs=&quot;type&quot;, group = &quot;condition&quot;)

DEGreport::degVolcano(
    as.data.frame(res[,c(&quot;log2FoldChange&quot;,&quot;padj&quot;)]), # table - 2 columns
    plot_text=as.data.frame(res[1:10,c(&quot;log2FoldChange&quot;,&quot;padj&quot;,&quot;id&quot;)])) # table to add names

# Available in the newer version for R 3.4
DEGreport::degPlotWide(dds = dds, genes = row.names(res)[1:5], group = &quot;condition&quot;)
</code></pre>

<hr />
<p><em>This lesson has been developed by members of the teaching team at the <a href="http://bioinformatics.sph.harvard.edu/">Harvard Chan Bioinformatics Core (HBC)</a>. These are open access materials distributed under the terms of the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license</a> (CC BY 4.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</em></p>
<ul>
<li><em>Materials and hands-on activities were adapted from <a href="http://www.bioconductor.org/help/workflows/rnaseqGene/#de">RNA-seq workflow</a> on the Bioconductor website</em></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../README/" title="Training materials" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Training materials
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>